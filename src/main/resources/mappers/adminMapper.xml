<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   	  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kosmo.uni.persistence.AdminDAO">

	<select id="getAttendance_Cnt" resultType="int">
		SELECT COUNT(*) as cnt
		FROM A_NFC
	</select>
	
	<select id="getAttendance_List" parameterType="java.util.Map"
		resultType="com.kosmo.uni.vo.AdminVO">
		<![CDATA[
			SELECT num, id, tagintime, tagouttime,pnum ,rNum 
			FROM (SELECT num, id, tagouttime,pnum, tagintime, rowNUM rNum
	    	FROM ( 
	        SELECT *FROM A_NFC n
	        JOIN A_ADMIN a
	        on n.pnum = a.tel))
			WHERE rNum >=#{start} AND rNum <=#{end}
    	]]>
	</select>
	
	<select id="getAttendance_Search_Cnt" parameterType="java.util.Map"
		resultType="int">
		<![CDATA[
		SELECT COUNT(*) AS CNT
		  FROM A_NFC
        WHERE SUBSTR(tagintime,1,10) BETWEEN #{st, jdbcType=VARCHAR} AND #{et, jdbcType=VARCHAR}
    	]]>
	</select>
	
	<select id="getAttendance_List_Search"
		parameterType="java.util.Map" resultType="com.kosmo.uni.vo.AdminVO">
		<![CDATA[
		SELECT *
  		  FROM (SELECT *
        	      FROM (SELECT num, id, tagouttime, pnum, tagintime, rowNUM rNum FROM A_NFC n
                JOIN A_ADMIN a
                  on n.pnum = a.tel
                  WHERE SUBSTR(tagintime,1,10) BETWEEN #{st, jdbcType=VARCHAR} AND #{et, jdbcType=VARCHAR}
                  ))
                  WHERE rNum >=#{start} AND rNum <=#{end}
		]]>
	</select>
	
	<select id="getSalary_Cnt" resultType="int">
		SELECT COUNT(*) as cnt
		FROM A_SALARY
	</select>

	<select id="getSalary_list_humanMonth" parameterType="java.util.Map"
		resultType="com.kosmo.uni.vo.AdminVO">
		<![CDATA[
		SELECT * 
	  	FROM (SELECT *
	    FROM (SELECT rowNUM rNum, salary_month, s.id, a.name, d.depart_name, paytotal
	                      , pay, meal, contract_vehicle, overtime
	    FROM a_salary s, a_admin a, a_depart d
	    where s.id = a.id
      	and a.depart = d.depart))
      	WHERE rNum >=#{start} and rNum <=#{end}
        ]]>
	</select>
	
	<select id="humanSearch_Cnt" parameterType="java.util.Map" resultType="int">
	<![CDATA[
		SELECT COUNT(*) as cnt
		FROM A_SALARY s, A_ADMIN a
		WHERE s.id = a.id
		AND name LIKE '%'||#{name, jdbcType=VARCHAR}||'%'
		]]>
	</select>
	
	<select id="humanSearch_List" parameterType="java.util.Map"
		resultType="com.kosmo.uni.vo.AdminVO">
	<![CDATA[
		    SELECT * from(
		    	SELECT * from(
		    		SELECT rowNUM rNum, salary_month, s.id, a.name, d.depart_name, paytotal, pay, meal, contract_vehicle, overtime
              		  FROM a_salary s, a_admin a, a_depart d
            WHERE s.id = a.id
            AND a.depart = d.depart
            AND name LIKE '%'||#{name, jdbcType=VARCHAR}||'%'))
            WHERE rNum >=#{start} and rNum <=#{end}
		    ]]>
	</select>
	
	<select id="monthSearch_Cnt" parameterType="java.util.Map" resultType="int">
	<![CDATA[
		SELECT COUNT(*) as cnt
		FROM A_SALARY s, A_ADMIN a
		WHERE s.id = a.id
		AND to_char(salary_month,'YYYYMM') BETWEEN #{sm, jdbcType=VARCHAR} AND #{em, jdbcType=VARCHAR}
		]]>
	</select>
	
	<select id="monthSearch_List" parameterType="java.util.Map"
		resultType="com.kosmo.uni.vo.AdminVO">
	<![CDATA[
		    SELECT * from(
		    	SELECT * from(
		    		SELECT rowNUM rNum, salary_month, s.id, a.name, d.depart_name, paytotal, pay, meal, contract_vehicle, overtime
              		  FROM a_salary s, a_admin a, a_depart d
            WHERE s.id = a.id
            AND a.depart = d.depart
            AND to_char(salary_month,'YYYYMM') BETWEEN #{sm, jdbcType=VARCHAR} AND #{em, jdbcType=VARCHAR}))
            WHERE rNum >=#{start} and rNum <=#{end}
		    ]]>
	</select>
	
	
	
	<insert id="salary_input" parameterType="java.util.Map">
		INSERT INTO a_salary_input
		VALUES (salaryList_seq.nextVal,#{salary_division},#{payments_division},#{payments_start},#{payments_end},#{salary_inday},#{payments_month},#{salary_name})
	</insert>
	
	<select id="getSalaryCnt" resultType="int">
		SELECT COUNT(*) as cnt FROM a_salary_input
	</select>
	
	<select id="getSalaryList" parameterType="java.util.Map" resultType="com.kosmo.uni.vo.SalaryInputVO">
		<![CDATA[
		SELECT * 
			FROM (SELECT salary_input_num, salary_division, payments_division, salary_confirm
	        , salary_inday, payments_month, salary_name, rowNUM rNum 
			FROM ( SELECT * FROM a_salary_input ORDER BY salary_input_num ASC)) 
		WHERE rNum >=#{start} AND rNum <=#{end}
		]]>
	</select>
	
	<select id="getCourseCnt" resultType="int">
		SELECT COUNT(*) as cnt FROM course
	</select>
	<select id="getCourseList" resultType="com.kosmo.uni.vo.CourseVO">
		SELECT distinct c.co_code co_code
            , c.co_name co_name
            , c.m_code m_code
            , c.p_code p_code
    		, c.limit_num limit_num
     		, c.co_num co_num
            , c.grade grade_1
     		, c.co_year co_year
            , c.co_semester co_semester
            , c.co_day co_day
            , c.le_code le_code
     		, p.name name_1
		  		FROM STUDENT_COURSE sc
		   			, STUDENT s
		   			, COURSE c
		   			, PROFESSOR p
		 			WHERE sc.id = s.id
				    AND sc.co_code = c.co_code
	</select>

	<select id="getAdminCnt" resultType="int">
		SELECT COUNT(*) as cnt FROM a_admin
	</select>
	
	<select id="getSelectList" parameterType="java.util.Map" resultType="com.kosmo.uni.vo.SalaryVO">
		SELECT m.id, m.name, m.rank, m.depart, 
				s.salary_input_num, s.payments_division, 
				s.salary_name, ss.salary, s.salary_inday, m.car
		  FROM a_salary_input s 
		  Join a_admin m
		    ON s.payments_division = m.Payments_division
		  JOIN a_salaryset ss
		    on ss.Rank = m.rank
		 where s.salary_input_num = #{salary_input_num}
	</select>
	
	<select id="getSelectCar" resultType="com.kosmo.uni.vo.SalaryVO">
		select * from a_variableCost where cost = #{cost}
	</select>
	
</mapper>